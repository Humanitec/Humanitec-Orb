description: >
  Notify Humanitec about a new available build
parameters:
  humanitec_token:
    type: string
    default:
    description: "Token to access Humanitec"
  organization:
    type: string
    default:
    description: "Name of the organization in Humanitec"
  module_name:
    type: string
    default:
    description: "Name of the module in Humanitec"
  image_name:
    type: string
    default:
    description: "Name of the image"
  humanitec_api:
    type: string
    default: "https://api.humanitec.io"
    description: "URL of the API to be used"
steps:
  - run:
      name: Notify Humanitec
      command: |
        "curl -XPOST -H 'Authorization: Bearer uwYu3g0yzwNRgX7e6HCvK4cJeshsDQl0CHtaZlJ07sEsRwOatfol6hvkZ2EOxfCu5npktQwfiEKdMrqkSSxFPimVwI3a2d6X2xBA' -H 'Content-type: application/json' -d '{\"commit\": \"'$CIRCLE_SHA1'\", \"branch\": \"'$CIRCLE_BRANCH'\",\"image\" : \"registry.humanitec.io/eficode/server:'$CIRCLE_WORKFLOW_ID'\"}' 'https://api.humanitec.io/orgs/eficode/modules/server/builds'"
